<link rel="stylesheet" href="/css/components/careers.css">

<section class="grad-careers-section">
    <div class="container-fluid">
        <div class="row g-0 align-items-center">

            <!-- Image Column - Hidden on mobile (same structure as contact) -->
            <div class="col-lg-5 d-none d-lg-block">
                <img src="/images/career.jpg" class="grad-careers-image" alt="Modern building exterior">
            </div>

            <!-- Form Column -->
            <div class="col-lg-7 d-flex justify-content-center">

                <div class="grad-careers-form-container text-dark p-4 p-md-5">
                    <p class="grad-careers-eyebrow text-uppercase mb-4">WE'RE ALWAYS LOOKING FOR TALENT</p>

                    <form id="careerForm" novalidate>
                        <div class="mb-4">
                            <input type="text" class="form-control grad-careers-input" id="careerName"
                                placeholder="Name" required>
                        </div>
                        <div class="mb-4">
                            <input type="tel" class="form-control grad-careers-input" id="careerPhone"
                                placeholder="Phone Number" required>
                        </div>
                        <div class="mb-4">
                            <input type="email" class="form-control grad-careers-input" id="careerEmail"
                                placeholder="Email" required>
                        </div>
                        <div class="mb-4">
                            <input class="form-control grad-careers-input" id="careerMessage"
                                placeholder="Area of Interest / Role" required></input>
                        </div>
                        <div class="mb-4">
                            <label for="careerResume" class="grad-careers-file-label">
                                <span class="grad-careers-file-text">Upload Resume</span>
                                <svg class="grad-careers-upload-icon" xmlns="http://www.w3.org/2000/svg" width="24"
                                    height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="17 8 12 3 7 8"></polyline>
                                    <line x1="12" y1="3" x2="12" y2="15"></line>
                                </svg>
                            </label>
                            <input type="file" class="form-control grad-careers-input d-none" id="careerResume"
                                required>
                            <span class="grad-careers-file-name" id="resumeFileName"></span>
                        </div>
                        <div class="mb-4">
                            <input class="form-control grad-careers-input" id="careerPortfolio" placeholder="Portfolio"
                                required></input>
                        </div>

                        <!-- Left Aligned Submit Button -->
                        <div class="text-start">
                            <button type="submit"
                                class="btn btn-dark grad-careers-submit-btn text-uppercase fw-bold">Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    // Careers form handler - embedded directly in the component
    document.addEventListener('DOMContentLoaded', function () {
        initializeCareersForm();
    });

    function initializeCareersForm() {
        const form = document.getElementById('careerForm');

        if (!form) {
            console.error("‚ùå Career form not found");
            return;
        }


        // Remove any existing event listeners
        const newForm = form.cloneNode(true);
        form.parentNode.replaceChild(newForm, form);
        const currentForm = document.getElementById('careerForm');

        currentForm.addEventListener('submit', function (e) {
            e.preventDefault();

            // Get form values
            const name = document.getElementById('careerName').value.trim();
            const phone = document.getElementById('careerPhone').value.trim();
            const email = document.getElementById('careerEmail').value.trim();
            const message = document.getElementById('careerMessage').value.trim();
            const portfolio = document.getElementById('carrerPortfolio').value.trim();

            // Basic validation
            if (!name || !phone || !email || !message) {
                alert("Please fill in all fields.");
                return;
            }

            // Create mailto link
            const subject = `Career Application - ${name}`;
            const body = `Name: ${name}\nPhone: ${phone}\nEmail: ${email}\n\nMessage:\n${message}\n\n---\nThis message was sent from the Grad Architects Careers page.`;

            const mailtoLink = `mailto:barathbalag@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;


            // Show loading state
            const submitBtn = currentForm.querySelector('.grad-careers-submit-btn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Opening Email...';
            submitBtn.disabled = true;

            // Open default email client
            setTimeout(() => {
                window.open(mailtoLink, '_blank');

                // Reset form and button
                setTimeout(() => {
                    currentForm.reset();
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    alert("Thank you for your application! Please send the pre-filled email to complete your application.");
                }, 2000);
            }, 1000);
        });
    }

    // Also initialize when component is loaded dynamically
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeCareersForm);
    } else {
        initializeCareersForm();
    }
</script>